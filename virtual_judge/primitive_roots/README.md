### Primitive Roots

---

讲真，这道题困扰了我很久，查找了很多材料，恕在下愚笨，理解了很长时间。

基本上就是欧拉函数相关数论定理的引用。

用到的定理有：

- 欧拉函数：给定一个数 n, 1 <= d <= n，其中 (d, n) = 1 的个数和，

就是小于等于 n 等于 1 的数中与 n 互质的个数便是欧拉函数的结果了。

以下记欧拉函数为 Phi(n);

- 原根的定义：如题目给出的定义，满足 0 < a < n, (a, n) = 1, 并且使得 a^d = 1 (mod n) 成立的最小的 d = Phi(n), 则 a 为模 n 的一个原根。 

另一个定义可以用于减少暴力求一个根时的计算：若 a 为模 n 的一个原根，这 a 满足 a^(Phi(n)/Pi) ≠ 1 (mod n)，其中 Pi 为 Phi(n) 质因子。

只要分解出 Phi(n) 的质因子，枚举一下，就可以判断 a 是否为一个原根，不需要从 1 开始枚举了。

- 模 n 的全部原根特性：若 g 为模 n 的一个原根，则其它原根可以根据 g^k = a (mod n), 1 <= k < Phi(n), 且 (k, Phi(n)) = 1 求得,

此时，a 为模 n 的一个原根。

不得不吐槽这里，就是这里费了我老大劲去理解，找到资料说的不明不白, 可能是自己比较愚笨，无法理解别人的说辞。

这里用一个确切的例子去说明。

先表明结果，模 11 的全部原根为：2, 6, 7, 8

假如我们先求得了其中的一个原根 2。

根据 g^k = a (mon n), 1 <= k < Phi(n), 且 (k, Phi(n)) = 1 有：

Phi(11) = 10;

k = 1, 3, 7, 9;

g = 2;

分别带入公式中，有：

2^1 = 2 (mond 11), 2^3 = 8 (mond 11), 2^7 = 7 (mod 11), 2^9 = 6 (mod 11);

于是求得全部原根：2, 8, 7, 6;

- 模 n 有原根的充要条件：n = 1, 2, 4, p^k, 2p^k，其中 p 为奇素数，k 为正整数。

详细的可以看代码，基本是就是根据以上几个定理，暴力求解的。

还涉及到一些快速求幂模的方法。
